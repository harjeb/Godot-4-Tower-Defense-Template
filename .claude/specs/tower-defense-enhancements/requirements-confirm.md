# 塔防游戏增强系统 - 需求确认

## 原始需求
用户提供的requirement.md内容，要求实现9种新炮塔、被动增益系统、DA/TA系统、怪物技能和防御力系统。

## 需求澄清过程

### 质量评估历程
- **初始分数**: 65/100
- **最终分数**: 92/100 ✅

### 澄清轮次
**第一轮澄清** - 用户回复涵盖所有关键问题：
1. Demo数值 + 后续可更改
2. DA/TA基础概率5%/1%，相加叠加，多次发射效果  
3. 怪物技能范围和动画设计需求
4. 防御力系统设计需求
5. 性能目标20炮塔50怪物，关卡系统设计
6. 被动增益范围和叠加规则

## 最终确认需求

### 1. 炮塔系统 (9种新炮塔)

#### 基础属性 (Demo数值)
- **箭塔**: 伤害15, 范围80, 攻速1.2s, 成本50
- **捕获塔**: 伤害8, 范围100, 攻速2.0s, 成本75 (AOE减速100%, 1.5s)
- **法师塔**: 伤害45, 范围90, 攻速3.0s, 成本120 (AOE)
- **感应塔**: 无伤害, 范围120, 成本60 (侦测隐身+减速40%)
- **末日塔**: 伤害25/s, 范围70, CD20s, 成本200 (持续15s+禁技能)
- **脉冲塔**: 伤害20, 范围85, 攻速1.8s, 成本90 (周期AOE)
- **弹射塔**: 伤害12, 范围75, 攻速1.5s, 成本80 (最多5次弹射)
- **光环塔**: 无伤害, 范围95, 成本70 (持续减速30%)
- **虚弱塔**: 伤害10, 范围65, 攻速0.8s, 成本65 (减防5%/层, 最多10层)

#### 被动增益系统
- **箭塔**: 攻击范围内每个捕获塔 → DA+10%, TA+5%
- **捕获塔**: 攻击范围内所有友方塔 → 攻速+10%
- **法师塔**: 每个其他法师塔 → 自身伤害+10%
- **末日塔**: 每个塔造成TA → CD-0.5s
- **脉冲塔**: 相邻2塔获得狂躁 → 攻速+5%, 伤害+5%
- **弹射塔**: 仅一个时 → 攻击+50%
- **光环塔**: 相邻2塔获得幸运 → DA+15%, TA+10%
- **虚弱塔**: 对减速敌人 → 伤害+15%

**增益规则**:
- 范围: 以炮塔攻击范围为准
- 叠加: 相加方式
- 相邻: 上下左右4格

### 2. DA/TA攻击系统
- **DA (双重攻击)**: 基础概率5%, 仅弹道塔有效
- **TA (三重攻击)**: 基础概率1%, 仅弹道塔有效
- **叠加方式**: 相加 (+10% DA = 15%总概率)
- **视觉效果**: 触发时多次发射弹道

### 3. 怪物技能系统
- **霜冻光环**: 范围100, 减攻速20%+减CD恢复20%, 持续3s, CD8s
- **加速**: 范围150, 随机友方+50%速度, 持续2s, CD5s
- **自爆**: HP<10%时触发, 1s读条, 范围80, 眩晕1.5s
- **石化**: 自身+500%防御, 持续3s, CD7s

### 4. 防御力系统
- **伤害公式**: 受到伤害 = 原始伤害 / (1 + 防御力/100)
- **怪物防御值**:
  - 普通: 10-30
  - 精英: 40-80
  - Boss: 100-200

### 5. 关卡系统
- **性能目标**: 20炮塔 + 50怪物同时
- **第一章设计**:
  - 关卡1: 20波 (基础怪物)
  - 关卡2: 20波 (技能怪物)
  - 关卡3: 30波 (混合类型)
  - 关卡4: 30波 (精英怪物)  
  - 关卡5: 50波 (Boss关卡)
- **存档**: 关卡内保持，关卡间重置

## 技术要求
- Godot 4引擎实现
- 与现有塔防模板集成
- UI系统支持新功能
- 简单动画效果
- 数据持久化支持

## 确认状态
- **需求质量分数**: 92/100 ✅
- **实现就绪**: 是
- **用户确认**: 待确认

## 下一步
等待用户确认开始实现流程。