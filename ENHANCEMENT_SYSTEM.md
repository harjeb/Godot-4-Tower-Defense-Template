# 塔防游戏增强系统

## 概述
本项目在原有塔防模板基础上添加了全面的增强系统，包括元素属性、敌人特殊能力、宝石装备、物品管理等功能，大幅提升了游戏的策略深度和可玩性。

## 新增功能

### 🔥 元素属性系统
- **7种元素类型**：火、冰、风、土、光、暗、无属性
- **克制关系**：
  - 循环克制：火 → 风 → 土 → 冰 → 火
  - 相互克制：光 ↔ 暗
  - 无属性：中性，不克制也不被克制
- **伤害倍率**：
  - 有利属性：+50% 伤害 (1.5x)
  - 被克制属性：-25% 伤害 (0.75x)
  - 中性属性：正常伤害 (1.0x)

### 👾 敌人特殊能力
- **隐身能力**：
  - 敌人半透明显示
  - 需要光属性炮塔才能在范围内检测
  - 增加战术考量
- **分裂能力**：
  - 敌人死亡时分裂成2个小单位
  - 最多可分裂2次（总计4个最小单位）
  - 分裂后单位血量和尺寸递减
- **治疗能力**：
  - 自动恢复10%最大血量
  - 冷却时间7秒
  - 增加持久战难度

### 💎 宝石装备系统
- **18种宝石**：6元素 × 3等级
  - 初级宝石：+10% 伤害
  - 中级宝石：+20% 伤害  
  - 高级宝石：+35% 伤害
- **合成机制**：2个低级宝石 → 1个高级宝石
- **装备系统**：每个炮塔有1个宝石插槽

### 🎒 物品管理系统
- **背包系统**：
  - 20个物品槽位
  - 支持物品叠加
  - 快捷键：I 键开启
- **武器盘系统**：
  - 10个圆形排列的BUFF槽位
  - 支持炮塔类型和元素类型BUFF
  - 快捷键：Tab 键开启
- **宝石合成界面**：
  - 可视化合成预览
  - 一键合成功能
  - 快捷键：C 键开启

### ⚔️ 战斗系统增强

- **BUFF叠加规则**：
  - 同类型BUFF：加算叠加
  - 不同类型BUFF：乘算叠加
- **物品掉落系统**：
  - 基础5%掉落概率
  - 基于敌人属性的掉落表
  - 视觉化掉落物品

## 技术架构

### 核心系统文件
- `Scenes/systems/ElementSystem.gd` - 元素属性计算
- `Scenes/systems/InventoryManager.gd` - 背包管理
- `Scenes/systems/WeaponWheelManager.gd` - 武器盘管理
- `Scenes/systems/LootSystem.gd` - 掉落系统

### 数据驱动设计
- `Scenes/main/Data.gd` - 所有游戏数据集中管理
- 易于扩展新元素、宝石、BUFF类型
- 保持与原有架构的兼容性

### UI界面
- `Scenes/ui/inventory/` - 背包界面
- `Scenes/ui/weaponWheel/` - 武器盘界面
- `Scenes/ui/gemCrafting/` - 宝石合成界面

## 使用方法

### 游戏内快捷键
- **I** - 打开/关闭背包
- **Tab** - 打开/关闭武器盘
- **C** - 打开/关闭宝石合成

### 基本流程
1. **击败敌人** → 获得物品掉落
2. **收集宝石** → 使用合成界面升级
3. **装备宝石** → 提升炮塔伤害
4. **配置武器盘** → 获得全局BUFF加成
5. **应对特殊敌人** → 使用对应策略

### 策略建议
- 根据敌人属性选择对应克制元素的宝石
- 光属性炮塔用于检测隐身敌人
- 区域攻击炮塔对付分裂敌人更有效
- 合理搭配武器盘BUFF最大化伤害

## 扩展性
系统采用数据驱动设计，支持轻松扩展：
- 添加新元素类型
- 增加更多敌人特殊能力
- 创建新的宝石和BUFF类型
- 设计更复杂的克制关系

## 兼容性
- 完全兼容原有游戏系统
- 不影响现有炮塔和敌人的基本功能
- 可选择性使用增强功能

---

**开发完成时间**: 2025年1月
**技术栈**: Godot 4.4, GDScript
**设计理念**: 策略深度 + 用户体验 + 技术可维护性